---
layout: post
title: "ã€ŒGmeekã€ä¸Šä¼ è„šæœ¬(å•ç¯‡æˆ–æ‰¹é‡)"
author: "Ronan"
header-style: text
tags:
  - docs
---

> [!caution]
>
> **æ³¨æ„ï¼š** è¯¥è„šæœ¬ä»…é€‚ç”¨äºé€šè¿‡Gmeeké¡¹ç›®æ­å»ºçš„åšå®¢ç½‘ç«™
> åœ¨å¼€å§‹ä½¿ç”¨ä¹‹å‰ï¼Œéœ€è¦åˆ›å»º github çš„ä¸ªäºº Token


# 1.åˆ›å»ºgithubä¸ªäººToken

1.åœ¨ GitHub ä¸Šä»»ä½•é¡µé¢çš„**å³ä¸Šè§’**ï¼Œå•å‡»æ‚¨çš„`ä¸ªäººèµ„æ–™ç…§ç‰‡`ï¼Œç„¶åå•å‡» `Settings`ã€‚  
2.åœ¨å·¦ä¾§è¾¹æ ä¸­ï¼Œå•å‡» `Developer settingsï¼ˆå¼€å‘äººå‘˜è®¾ç½®ï¼‰`ã€‚  
3.åœ¨å·¦ä¾§è¾¹æ ä¸­çš„ **Personal access tokens ï¼ˆä¸ªäººè®¿é—®ä»¤ç‰Œï¼‰** ä¸‹ï¼Œå•å‡» `Tokens ï¼ˆclassicï¼‰`ã€‚  
4.é€‰æ‹© `Generate new tokenï¼ˆç”Ÿæˆæ–°ä»¤ç‰Œï¼‰`ï¼Œç„¶åå•å‡» `Generate new token ï¼ˆclassicï¼‰`ã€‚  
5.åœ¨ **Note** å­—æ®µä¸­ï¼Œä¸ºæ‚¨çš„ä»¤ç‰ŒæŒ‡å®šä¸€ä¸ªæè¿°æ€§åç§°ã€‚  
6.è¦ä¸ºæ‚¨çš„ä»¤ç‰ŒæŒ‡å®šè¿‡æœŸæ—¶é—´ï¼Œè¯·é€‰æ‹© **Expirationï¼ˆè¿‡æœŸï¼‰**ï¼Œç„¶åé€‰æ‹©é»˜è®¤é€‰é¡¹æˆ–å•å‡» Customï¼ˆè‡ªå®šä¹‰ï¼‰ä»¥è¾“å…¥æ—¥æœŸã€‚  
7.é€‰æ‹©è¦æˆäºˆæ­¤ä»¤ç‰Œçš„èŒƒå›´ã€‚è¦ä½¿ç”¨ä»¤ç‰Œä»å‘½ä»¤è¡Œè®¿é—®å­˜å‚¨åº“ï¼Œè¯·é€‰æ‹© `repo` ( **è¿™é‡Œä¸€å®šè¦æ‰“ä¸Šå‹¾ï¼ï¼ï¼** ) ã€‚æ²¡æœ‰åˆ†é…èŒƒå›´çš„ä»¤ç‰Œåªèƒ½è®¿é—®å…¬å…±ä¿¡æ¯ã€‚  
8.æ»‘åŠ¨åˆ°åº•éƒ¨ï¼Œå•å‡» `Generate token`  
9.**å°†æ–°ä»¤ç‰Œå¤åˆ¶åˆ°å‰ªè´´æ¿å¹¶ä¸”ä¿ç®¡å¥½ï¼Œä»¤ç‰Œåªå‡ºç°ä¸€æ¬¡ï¼Œä¸€å®šè¦ä¿ç®¡å¥½ï¼ä¸€å®šè¦ä¿ç®¡å¥½ï¼ä¸€å®šè¦ä¿ç®¡å¥½ï¼**ã€‚  


# 2.ä½¿ç”¨æ–¹æ³•
ä»¥ä¸‹æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†ä¸ºshè„šæœ¬å’Œpythonè„šæœ¬ï¼š

> [!tip]
> **å»ºè®®ï¼š**
> Linuxä¸macç³»ç»Ÿä½¿ç”¨ sh è„šæœ¬ï¼ŒWindowsä½¿ç”¨pyè„šæœ¬ä½“éªŒæ›´ä½³
> ä¹Ÿå¯æ ¹æ®å–œå¥½è‡ªè¡Œé‡‡ç”¨

## 2.1é…ç½®è„šæœ¬

### å¯¹äº sh è„šæœ¬
> [!important]
>
> ä½¿ç”¨å‰éœ€ç¡®è®¤ä»¥ä¸‹ï¼š
> - ç³»ç»Ÿå·²å®‰è£…curl
> - ç³»ç»Ÿå·²å®‰è£…jq
> - ç³»ç»Ÿå¯ä½¿ç”¨bash

curlã€jq å®‰è£…æ–¹æ³•ç”±äºç³»ç»Ÿä¸åŒï¼Œæ–¹æ³•å¤šæ ·ï¼Œæ‰€ä»¥å…·ä½“å®‰è£…æ–¹æ³•å¯ä»¥è‡ªè¡ŒæŸ¥æ‰¾...

åœ¨ä»£ç å¼€å§‹çš„å‰å‡ è¡Œï¼Œæ‰¾åˆ°ä»¥ä¸‹å‡ ä¸ªå€¼ï¼Œåœ¨å¼•å·é‡Œå¡«å…¥è‡ªå·±çš„ä¿¡æ¯ï¼š

- `TOKEN`  ä¸ºè‡ªå·±åˆ›å»ºçš„Tokenå€¼
- `OWNER` ä¸ºè‡ªå·±çš„githubç”¨æˆ·å
- `REPO` ä¸ºè‡ªå·±çš„Gmeekåšå®¢ä»“åº“åï¼Œä¸€èˆ¬æ˜¯ `xxx.github.io`
  
  
### å¯¹äº py è„šæœ¬

1.åœ¨å¼€å§‹ä½¿ç”¨ä¹‹å‰ï¼Œéœ€è¦å®‰è£… `requests` æ¨¡å—

```shell
pip3 install requests
```

2.æ‰¾åˆ°ä»£ç æœ€åå‡ è¡Œï¼Œåœ¨å¼•å·é‡Œé¢å¡«å…¥ï¼š

- `token` ä¸ºè‡ªå·±åˆ›å»ºçš„Tokenå€¼
- `owner` ä¸ºè‡ªå·±çš„githubç”¨æˆ·å
- `repo` ä¸ºè‡ªå·±çš„Gmeekåšå®¢ä»“åº“åï¼Œä¸€èˆ¬æ˜¯ `xxx.github.io`

<details>
  <summary> ğŸ‘‰ç‚¹æˆ‘å±•å¼€çœ‹shè„šæœ¬ä»£ç ================================= </summary>
  <pre><code>

#!/usr/bin/env bash

TOKEN=''
OWNER=''
REPO=''

# ä¸Šä¼ ä¸»ç¨‹åº
main_upload_program() {
    local title=$1
    local content=$2
    local labels=$3

    # å°†æ ‡ç­¾è½¬æ¢æˆ JSON æ•°ç»„æ ¼å¼
    labels_json=$(echo "$labels" | sed 's/,/","/g' | sed 's/^/["/' | sed 's/$/"]/')

    # æ„å»º JSON æ•°æ®
    json_data=$(jq -n \
    --arg title "$title" \
    --arg body "$content" \
    --argjson labels "$labels_json" \
    '{title: $title, body: $body, labels: $labels}')

    # å‘é€ POST è¯·æ±‚
    status_code=$(    curl -L \
        --silent \
        --output /dev/null \
        --write-out "%{http_code}" \
        -X POST \
        -H "Accept: application/vnd.github+json" \
        -H "Authorization: Bearer $TOKEN" \
        -H "X-GitHub-Api-Version: 2022-11-28" \
        https://api.github.com/repos/$OWNER/$REPO/issues \
        -d "$json_data" )

    case $status_code in
        201)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "ä¸Šä¼ æˆåŠŸ"
        ;;
        400)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "Bad Request, é”™è¯¯è¯·æ±‚"
        ;;
        403)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "Forbidden"
        ;;
        404)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "Resource not found"
        ;;
        410)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "Gone"
        ;;
        422)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "Validation failed, or the endpoint has been spammed. \n éªŒè¯å¤±è´¥ï¼Œæˆ–ç»ˆç»“ç‚¹å·²æ”¶åˆ°åƒåœ¾é‚®ä»¶ã€‚"
        ;;
        502)
            echo
            echo "è¿”å›ç ï¼š$status_code"
            echo "Service unavailable, æœåŠ¡ä¸å¯ç”¨"
        ;;
    esac

}

# ä¸Šä¼ å•ç¯‡æ–‡ç« 
upload_single_post() {
    read -p "è¯·è¾“å…¥æ–‡ç« è·¯å¾„ï¼š" file_path
    read -p "è¯·è¾“å…¥æ–‡ç« æ ‡ç­¾(å¤šä¸ªæ ‡ç­¾è¯·ç”¨,éš”å¼€)ï¼š" labels

    if echo "$file_path" | grep -E '\.(md|txt)$' > /dev/null; then
        # æå–æ–‡ä»¶åå¹¶å»æ‰æ‰©å±•å
        file_name=$(basename "$file_path")
        title=$(echo "$file_name" | sed 's/\.[^.]*$//')

        # è·å–æ–‡ç« å†…å®¹
        content=$(sed "" "$file_path")

        main_upload_program "$title" "$content" "$labels"
    fi

}

# æ‰¹é‡ä¸Šä¼ 
upload_batch_posts() {
    read -p "è¯·è¾“å…¥è¦ä¸Šä¼ çš„æ–‡ä»¶ç›®å½•(ç»å¯¹ã€ç›¸å¯¹è·¯å¾„çš†å¯)ï¼š" file_path
    read -p "è¯·è¾“å…¥æ–‡ç« æ ‡ç­¾(å¤šä¸ªæ ‡ç­¾è¯·ç”¨,éš”å¼€)ï¼š" labels
    for file in "${file_path}"/*
    do
        if echo "$file" | grep -E '\.(md|txt)$' > /dev/null; then
            # æå–æ–‡ä»¶åå¹¶å»æ‰æ‰©å±•å
            file_name=$(basename "$file")
            title=$(echo "$file_name" | sed 's/\.[^.]*$//')

            # è·å–æ–‡ç« å†…å®¹
            content=$(sed "" "$file")

            main_upload_program "$title" "$content" "$labels"
        fi

    done
}


while true;do
    echo " -----Made by Ronan----- "
    echo " åœ¨é”®ç›˜ä¸ŠæŒ‰ä¸‹å¯¹åº”æ•°å­—å³å¯é€‰æ‹©ç›¸åº”è®¾ç½®"
    echo "â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”"
    echo " 1. ä¸Šä¼ å•ç¯‡æ–‡ç« "
    echo " 2. æ‰¹é‡ä¸Šä¼ "
    echo " Q. é€€å‡ºæœ¬ç¨‹åº"
    echo
    read -p "è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹: " status
    case $status in
        1)
            upload_single_post
            break
        ;;
        2)
            upload_batch_posts
            break
        ;;
        q | Q)
            echo "é€€å‡º"
            exit 0
        ;;
        *)
            echo "æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡æ–°é€‰æ‹©ã€‚"
        ;;
    esac
done
</code></pre>
</details>

<details>
  <summary> ğŸ‘‰ç‚¹æˆ‘å±•å¼€çœ‹pyè„šæœ¬ä»£ç ================================= </summary>
  <pre><code>

import json
import os
import requests

class GitHubIssueUploader:
    def __init__(self, owner=None, repo=None, token=None):
        self.owner = owner
        self.repo = repo
        self.token = token

        # æ£€æŸ¥æ˜¯å¦æä¾›äº†å¿…è¦çš„å‚æ•°
        if not self.owner or not self.repo or not self.token:
            raise ValueError("å¿…é¡»æŒ‡å®š owner, repo å’Œ token")
        else:
            self.start_upload()

    def create_issue(self, title, content, labels):

        url = f"https://api.github.com/repos/{self.owner}/{self.repo}/issues"

        headers = {
            "Accept": "application/vnd.github+json",
            "Authorization": f"Bearer {self.token}",
            "X-GitHub-Api-Version": "2022-11-28"
        }

        data = {
            "title": title,
            "body": content,
            "labels": labels
        }

        response = requests.post(url=url, headers=headers, json=data)

        match response.status_code:
            case 201:
                print("Created, ä¸Šä¼ æˆåŠŸ")
            case 400:
                print("Bad Request, é”™è¯¯è¯·æ±‚")
            case 403:
                print("Forbidden")
            case 404:
                print("Resource not found")
            case 410:
                print("Gone")
            case 422:
                print("Validation failed, or the endpoint has been spammed. \n éªŒè¯å¤±è´¥ï¼Œæˆ–ç»ˆç»“ç‚¹å·²æ”¶åˆ°åƒåœ¾é‚®ä»¶ã€‚")
            case 502:
                print("Service unavailable, æœåŠ¡ä¸å¯ç”¨")

    def upload_single_post(self, file_path, labels):
        title = os.path.splitext(os.path.basename(file_path))[0]
        with open(file_path, 'r', encoding='utf-8') as file:
            content = file.read()
            self.create_issue(title, content, labels)

    def upload_batch_posts(self, directory, labels):
        for filename in os.listdir(directory):
            if filename.endswith('.md') or filename.endswith('.txt'):
                file_path = os.path.join(directory, filename)
                self.upload_single_post(file_path, labels)

    def start_upload(self):
        status = input("\n 1.ä¸Šä¼ å•ç¯‡æ–‡ç«  \n 2.æ‰¹é‡ä¸Šä¼  \n æŒ‰ä¸‹å¯¹åº”æ•°å­—å¹¶å›è½¦å¯é€‰æ‹©ç›¸åº”åŠŸèƒ½ï¼š")
        labels = input("è¯·è¾“å…¥æ ‡ç­¾ï¼Œç”¨,éš”å¼€ï¼š")
        labels = [word.strip() for word in labels.split(',')]

        if status == "1":
            file_path = input("è¯·è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼š")
            self.upload_single_post(file_path, labels)
        elif status == "2":
            directory = input("è¯·è¾“å…¥ç›®å½•è·¯å¾„ï¼š")
            self.upload_batch_posts(directory, labels)
        else:
            print("å·²é€€å‡ºç¨‹åº...")
            exit()


if __name__ == "__main__":
    uploader = GitHubIssueUploader(
        owner = "xxxx",
        repo = "xxxx.github.io",
        token = "xxxx"
    )

</code></pre>
</details>


## 2.2è¿è¡Œè„šæœ¬

- å¯¹äºshè„šæœ¬

å°†ä»¥ä¸Šè„šæœ¬ä»£ç ä¿å­˜ä¸º `blog_upload.sh` ï¼Œåœ¨ç»ˆç«¯é‡Œè¿›å…¥åˆ°æ”¹è„šæœ¬æ‰€åœ¨ä½ç½®ï¼Œé”®å…¥ `chmod 777 blog_upload.sh` ï¼Œç„¶åé€šè¿‡ `./blog_upload.sh` è¿è¡Œï¼Œä¹‹åæ ¹æ®æç¤ºè¿›è¡Œå³å¯ã€‚


- å¯¹äºpyè„šæœ¬

å°†è„šæœ¬ä»£ç ä¿å­˜ä¸º `blog_upload.py` ï¼Œåœ¨ç»ˆç«¯é‡Œè¿›å…¥åˆ°æ”¹è„šæœ¬æ‰€åœ¨ä½ç½®ï¼Œç„¶åé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œï¼Œä¹‹åæ ¹æ®æç¤ºè¿›è¡Œå³å¯ã€‚

```python
python3 blog_upload.py
```

ä½ é—®æˆ‘é…ç½®å®Œäº†è„šæœ¬æ€ä¹ˆç”¨ï¼Ÿä½ è¿è¡Œèµ·æ¥æœ‰æ­¥éª¤å¼•å¯¼ä½ çš„ï½ï½ï½

<!-- ##{"timestamp":1722611382}## -->
